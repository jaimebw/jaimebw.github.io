---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("posts");
posts.sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
);

const formatDate = (value: Date) =>
  value.toLocaleDateString("en-US", {
    year: "numeric",
    month: "short",
    day: "numeric",
  });
---
<BaseLayout title="Hola! Qué tal? I'm Jaime" description="Aero-Software Engineer">
  <section class="hero">
    <h1>Hola! Qué tal? I'm Jaime</h1>
    <p>Aero-software engineer tinkering with avionics, tooling, and monospace aesthetics.</p>
    <p class="chip">Latest writing + projects</p>
  </section>

  <section>
    <h2>Posts</h2>
    <div class="post-list">
      {posts.map((post) => (
        <article class="post-card">
          <a href={`/${post.slug}/`}>
            <h2>{post.data.title}</h2>
          </a>
          {post.data.subtitle && <p>{post.data.subtitle}</p>}
          <time datetime={post.data.date.toISOString()}>
            {formatDate(post.data.date)}
          </time>
          {post.data.tags && post.data.tags.length > 0 && (
            <div class="tag-cloud">
              {post.data.tags.map((tag) => (
                <a href={`/tags#${tag}`}>{tag}</a>
              ))}
            </div>
          )}
        </article>
      ))}
    </div>
  </section>
</BaseLayout>
